<?php

use \Veles\Helper;

/**
 * Generated by PHPUnit_SkeletonGenerator 1.2.0 on 2012-12-20 at 12:06:50.
 */
class HelperTest extends PHPUnit_Framework_TestCase
{
    /**
     * @group RootClasses
     * @covers Veles\Helper::genStr
     * @dataProvider genStrProvider
     */
    public function testGenStr($length, $letters)
    {
        $result          = Helper::genStr($length, $letters);
        $result_length   = strlen($result);
        $unknown_array   = array();

        $this->assertInternalType('string', $result, 'Wrong result type: ' . gettype($result));
        $this->assertEquals($length, $result_length, "Wrong result length: $result_length");

        for ($i = 0; $i < $result_length; ++$i) {
            if (false === strpos($letters, $result[$i])) {
                $unknown_array[] = '"' . $result[$i] . '"';
            }
        }

        $this->assertTrue(empty($unknown_array),
            'Result contains unknown symbols: ' . implode(',', $unknown_array)
        );
    }

    /**
     * DataProvider for HelperTest::testGenStr()
     */
    public function genStrProvider()
    {
        return array(
            array(21, 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789./'),
            array(30, 'ABCDEFGHIJKLMNOPQRSTUVWX%$#'),
            array(30, 'A|@абвгдеёжзийклмнопрстуфхцчшщъыьэюя%$#')
        );
    }

    /**
     * @group RootClasses
     * @covers Veles\Helper::validateEmail
     * @dataProvider validateEmailProvider
     */
    public function testValidateEmail($email, $expected)
    {
        $result = Helper::validateEmail($email);

        $this->assertTrue($expected === $result,
            "Email \"$email\" has wrong validation result: " . (($result) ? '"true"' : '"false"')
        );
    }

    /**
     * DataProvider for HelperTest::testValidateEmail
     */
    public function validateEmailProvider()
    {
        return array(
            array('nd_lk.test-pro@mail.ru', true),
            array('nd/lk@mail.ru', false),
            array('длоndlk@mail.ru', false),
            array('email@wrong-domain', false),
            array('email@wrong_domain.wrongld', false),
            array('email@wrong_domain.wro-d', false)
        );
    }

    /**
     * @group RootClasses
     * @covers Veles\Helper::checkEmailDomain
     * @dataProvider checkEmailDomainProvider
     */
    public function testCheckEmailDomain($email, $expected)
    {
        $result = Helper::checkEmailDomain($email);

        $this->assertTrue($expected === $result,
            "Email \"$email\" has wrong check domain result: " . (($result) ? '"true"' : '"false"')
        );
    }

    /**
     * DataProvider for HelperTest::testCheckEmailDomain
     */
    public function checkEmailDomainProvider()
    {
        return array(
            array('mail@google.com', true),
            array('mail@yandex.ru', true),
            array('error@wrongdomain.opa-opa', false)
        );
    }

    /**
     * @group RootClasses
     * @covers Veles\Helper::translit
     * @dataProvider translitProvider
     */
    public function testTranslit($text, $expected)
    {
        $result = Helper::translit($text);

        $this->assertTrue($expected === $result,
            "Text \"$text\" has wrong translit result: \"$result\""
        );
    }

    /**
     * DataProvider for HelperTest::testTranslit
     */
    public function translitProvider()
    {
        return array(
            array('АБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯабвгдеёждийклмнопрстуфхцчшщъыьэюя ".,!?()#@*&[]:;<>+', 'abvgdeyozhzijklmnoprstufhtschshshhyeyuyaabvgdeyozhdijklmnoprstufhtschshshhyeyuya-')
        );
    }

    /**
     * @group RootClasses
     * @covers Veles\Helper::makeAlias
     * @depends testTranslit
     * @dataProvider makeAliasProvider
     */
    public function testMakeAlias($url, $expected)
    {
        $result = Helper::makeAlias($url);

        $this->assertTrue($expected === $result,
            "URL \"$url\" has wrong make alias result: \"$result\""
        );
    }

    /**
     * DataProvider for HelperTest::testMakeAlias
     */
    public function makeAliasProvider()
    {
        return array(
            array('Кровельная черепица', 'krovelnaya-cherepitsa'),
            array('Внеземные цивилизации', 'vnezemnye-tsivilizatsii')
        );
    }
}
